@model IEnumerable<QuanLyThueXe.Models.Reservation>
@using QuanLyThueXe.Helpers

@{
    ViewData["Title"] = "L·ªãch s·ª≠ ƒë·∫∑t xe c·ªßa t√¥i";
}

<div class="container mt-4">
    <h2 class="mb-4">üìã L·ªãch s·ª≠ ƒë·∫∑t xe c·ªßa t√¥i</h2>

    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            @TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    @if (TempData["InfoMessage"] != null)
    {
        <div class="alert alert-info alert-dismissible fade show" role="alert">
            @TempData["InfoMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    @if (Model != null && Model.Any())
    {
        <div class="row">
            @foreach (var reservation in Model)
            {
                <div class="col-md-6 mb-4">
                    <div class="card shadow-sm h-100">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">ƒê∆°n #@reservation.ReservationId</h5>
                            @if (reservation.Status == "Pending")
                            {
                                <span class="badge bg-warning">Ch·ªù duy·ªát</span>
                            }
                            else if (reservation.Status == "Approved")
                            {
                                <span class="badge bg-success">ƒê√£ duy·ªát</span>
                            }
                            else if (reservation.Status == "Cancelled")
                            {
                                <span class="badge bg-danger">ƒê√£ h·ªßy</span>
                            }
                            else
                            {
                                <span class="badge bg-secondary">@reservation.Status</span>
                            }
                        </div>
                        <div class="card-body">
                            @if (reservation.Car != null)
                            {
                                <div class="row mb-3">
                                    <div class="col-4">
                                        <img src="@ImageHelper.GetCarImageUrl(reservation.Car)" 
                                             alt="@reservation.Car.Brand @reservation.Car.Model" 
                                             class="img-fluid rounded" 
                                             style="max-height: 100px; object-fit: cover;" />
                                    </div>
                                    <div class="col-8">
                                        <h6>@reservation.Car.Brand @reservation.Car.Model</h6>
                                        <p class="mb-1"><small>Bi·ªÉn s·ªë: @reservation.Car.LicensePlate</small></p>
                                        <p class="mb-0"><small>Gi√°: @PriceHelper.FormatPrice(reservation.Car.PricePerDay)/ng√†y</small></p>
                                    </div>
                                </div>
                            }

                            <hr />

                            <p class="mb-1">
                                <strong>Ng√†y ƒë·∫∑t:</strong> 
                                @DateHelper.FormatDateTime(reservation.ReservationDate)
                            </p>
                            <p class="mb-0">
                                <strong>Tr·∫°ng th√°i:</strong> 
                                @if (reservation.Status == "Pending")
                                {
                                    <span class="text-warning">‚è≥ Ch·ªù duy·ªát - Nh√¢n vi√™n s·∫Ω li√™n h·ªá v·ªõi b·∫°n s·ªõm nh·∫•t</span>
                                }
                                else if (reservation.Status == "Approved")
                                {
                                    <span class="text-success">‚úÖ ƒê√£ ƒë∆∞·ª£c duy·ªát - Vui l√≤ng ƒë·∫øn c·ª≠a h√†ng ƒë·ªÉ ho√†n t·∫•t th·ªß t·ª•c</span>
                                }
                                else if (reservation.Status == "Cancelled")
                                {
                                    <span class="text-danger">‚ùå ƒê√£ b·ªã h·ªßy</span>
                                }
                                else
                                {
                                    <span>@reservation.Status</span>
                                }
                            </p>
                        </div>
                        <div class="card-footer">
                            <a asp-action="Details" asp-route-id="@reservation.ReservationId" 
                               class="btn btn-sm btn-outline-primary">
                                üëÅÔ∏è Xem chi ti·∫øt
                            </a>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <div class="alert alert-info text-center">
            <h5>B·∫°n ch∆∞a c√≥ ƒë∆°n ƒë·∫∑t xe n√†o</h5>
            <p>H√£y ch·ªçn m·ªôt chi·∫øc xe v√† ƒë·∫∑t thu√™ ngay!</p>
            <a asp-controller="Home" asp-action="Index" class="btn btn-primary">
                üöó Xem danh s√°ch xe
            </a>
        </div>
    }

    <div class="mt-4">
        <a asp-controller="Home" asp-action="Index" class="btn btn-secondary">
            ‚¨ÖÔ∏è Quay l·∫°i trang ch·ªß
        </a>
    </div>
</div>

